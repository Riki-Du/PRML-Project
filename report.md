# 模式识别与机器学习 Project - [AI Cures](https://www.aicures.mit.edu/)

杜逸闲

宁晨然

## 问题描述

给出若干种化合物的SMILES表示，要求判断其是否对Covid-19具有抗性，输出为0或者1，是一个2分类问题。

### 化合物的SMILES表示

SMILES (implified molecular input line entry specification), 是一种用ASCII字符串描述分子结构的规范，语法如下：

1. 原子用方括号内的化学元素表示，可以省略，如`[Au]`表示金原子。在有机物中只有C、N、O、P、S、Br、Cl、I可以省略方括号。
2. 氢原子忽略不写，当化合价不足时用氢原子补足。如水的SMILES是`O`。
3. 原子间双键用'='表示，三键用'#'表示。
4. 如果结构中有环，将环断开并在断开的两个原子旁用同一个数字标记，表示原子间有键相连。
5. 芳香环中的C、O、S、N原子分别用小写字母c, o, s, n表示。
6. 分支结构用圆括号表示。

下面是一些实例：
1. 水：O 
   
   ![水](水.jpg)
2. 乙醇：CCO 
   
   ![乙醇](乙醇.jpg)
3. 二氧化碳：O=C=O 
   
   ![二氧化碳](二氧化碳.jpg)
4. 氰化氢：C#N 
   
   ![氰化氢](氰化氢.jpg)
5. 环已烷：C1CCCCC1 
   
   ![环已烷](环已烷.jpg)
6. 乙烷：CC 
   
   ![乙烷](乙烷.jpg)
7. 乙烯：C=C 
   
   ![乙烯](乙烯.jpg)
8. 乙炔：C#C
   
   ![乙炔](乙炔.jpg)
9. 乙酸乙酯：CC(=O)OCC 
    
   ![乙酸乙酯](乙酸乙酯.jpg)

### 数据集获取

在[官方论坛](https://www.aicures.mit.edu/forum/_data)填写自己的姓名和邮箱可以获取到数据本次Benchmark的数据，也可以在[数据页面](https://www.aicures.mit.edu/data)下载其他数据集。

## 评价标准

了解数据评价标准可以帮助我们更好的评价自己的模型。该任务的评价标准有四个，见[Task页面](https://www.aicures.mit.edu/tasks)下的排名. 

![评价标准](评价标准.png)

### 交叉验证

由于该数据集的规模较小，为了防止过拟合，数据集将被平分为10份。每次训练我们选取其中的9份作为训练集，剩下的1份作为验证集。上图的10-fold CV (cross validation)前缀就代表交叉验证。

### ROC-AUC && PRC-AUC

对于交叉验证和总测试集，我们都有两个指标，ROC-AUC和PRC-AUC, 他们均能一定程度上反应分类器的性能，但在本项目中PRC-AUC会用作分类器排序的第一参数。我们将分别介绍ROC-AUC和PRC-AUC并分析为何PRC-AUC在此项目中更为重要。

在一个二分类任务中，对于一个分类器的预测结果，我们有如下的定义：

1. $TP$, True Positive为真正例（测试集标记为正，分类器预测为正）的数量。
2. $FP$, False Positive为假正例（测试集标记为负，而分类器预测为正）的数量。
3. $FN$, False Negative为假负例（测试集标记为正，分类器预测为负）的数量。
4. $TN$, True Negative为真负例（测试集标记为负，分类器预测为负）的数量。

在了解ROC之前，我们定义两个指标：

1. 真正例率 (True Positive Rate, TPR), 表示所有正例中，预测为正例的比例： 
   $$TPR = \frac{TP}{TP + FN}$$
2. 假正例率 (False, Positive Rate, FPR), 表示所有负例中，预测为正例的比例：
   $$FPR = \frac{FP}{TN + FP}$$

在一个二分任务里，很多分类器输出一个实数值或者一个概率，接着设定一个阈值，当高于这个阈值时标记为正例，反之标记为负例。

因此，当改变这个阈值的时候，$TPR$和$FPR$也会相应的改变。我们以$FPR$为横坐标，$TPR$为纵坐标，当阈值改变时就可以得到一系列的点（很显然这些点关于阈值的函数是“连续”的），我们将这些点连接起来平滑处理就可以得到ROC曲线了。

![ROC曲线](ROC曲线.png)